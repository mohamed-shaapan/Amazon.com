<!DOCTYPE html>
<html>
	
	<!-- DEFINE HEADER -->
	<!-- *********************************************** -->
	<head>

		<link rel="stylesheet" href="http://www.w3schools.com/lib/w3.css">
		<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<style>
		
			.sh-form{
				width: 600px; padding-top: 0px; padding-bottom: 20px; padding-left: 20px; margin-top: 25px;
			}

			.sh-label{
				width: 100px; padding-top: 8px; padding-right: 10px; text-align: right;
			}

		</style>

	</head>
	

	<!-- DEFINE BODY -->
	<!-- *********************************************** -->
	<body class="w3-light-grey">
		
		<!-- side tabs -->
		<nav class="w3-sidenav w3-card-2 w3-white" style="width:250px">

			<!-- logo -->
			<div class="w3-blue-grey" style="padding-left: 23px; padding-top: 40px; padding-bottom: 30px;">
				<img id="logo_image" alt="logo">
			</div>
		  
		  	<!-- user name -->
		  	<div id="display_user_name" class="w3-container"
		  		style="padding-top: 20px; font-weight: bold; padding-bottom: 10px;">
		  		User_Name
		  	</div>

		  	<!-- customer access -->
			<a id="home_btn" href="#">Home</a>
			<a id="account_btn" href="#" class="w3-blue-grey">Account</a>
			<a id="cart_btn" href="#">Shopping Cart</a>
			<a id="my_orders_btn" href="#">My Orders</a>
			<a id="signout_btn" href="#">Sign Out</a>

			<!-- admin controls -->
			<div id="admin_controls" style='display: none;'>
				<div class="w3-container" style="padding-top: 20px; font-weight: bold; padding-bottom: 5px;">
					Admin Controls
				</div>
				<a id="manage_inventory_btn" href="#">Manage Inventory</a>
				<a id="manage_publishers_btn" href="#">Manage Publishers</a>
				<a id="publisher_orders_btn" href="#">Publisher Orders</a>
				<a id="user_accounts_btn" ref="#">User Accounts</a>
			</div>

		</nav>
		
		<!-- page content -->
		<div class="w3-container" style="margin-left: 250px; padding-left: 0px;">
			<div style="height:20px;">
			</div>

			<!-- page title -->
			<div class="w3-container w3-center" style="margin-bottom:10px;">
				<span class="w3-text-blue-grey" style="font-size:27px; font-weight:bold; font-family: arial;">Account Info</span>
			</div>
			
			<!-- account info -->
			<div style="display: table; margin: 0 auto;">
			<div class="sh-form">

				<!-- user name -->
				<div class="w3-row" style="padding: 10px;">
					<div class="w3-col sh-label">
						<label class="w3-label" style="text-align: right;" >User Name</label>
					</div>

					<div class="w3-col" style="width: 400px;">
						<input type="text" class="w3-input w3-border sh-input" required id="user_name" disabled />
					</div>
				</div>

				<!-- password -->
				<div class="w3-row" style="padding: 10px;">
					<div class="w3-col sh-label">
						<label class="w3-label">Password</label>
					</div>

					<div class="w3-col" style="width: 400px;">
						<input type="password" class="w3-input w3-border sh-input" required id="user_password" disabled />
					</div>
				</div>

				<!-- first name -->
				<div class="w3-row" style="padding: 10px;">
					<div class="w3-col sh-label">
						<label class="w3-label">First Name</label>
					</div>

					<div class="w3-col" style="width: 400px;">
						<input type="text" class="w3-input w3-border sh-input" required id="first_name" disabled />
					</div>
				</div>

				<!-- last name -->
				<div class="w3-row" style="padding: 10px;">
					<div class="w3-col sh-label">
						<label class="w3-label">Last Name</label>
					</div>

					<div class="w3-col" style="width: 400px;">
						<input type="text" class="w3-input w3-border sh-input" required id="last_name" disabled />
					</div>
				</div>

				<!-- user email -->
				<div class="w3-row" style="padding: 10px;">
					<div class="w3-col sh-label">
						<label class="w3-label">Email</label>
					</div>

					<div class="w3-col" style="width: 400px;">
						<input type="text" class="w3-input w3-border sh-input" required id="user_email" disabled />
					</div>
				</div>

				<!-- user phone -->
				<div class="w3-row" style="padding: 10px;">
					<div class="w3-col sh-label">
						<label class="w3-label">Phone</label>
					</div>

					<div class="w3-col" style="width: 400px;">
						<input type="text" class="w3-input w3-border sh-input" required id="user_phone" disabled />
					</div>
				</div>

				<!-- shipping address -->
				<div class="w3-row" style="padding: 10px;">
					<div class="w3-col sh-label">
						<label class="w3-label">Address</label>
					</div>

					<div class="w3-col" style="width: 400px;">
						<input type="text" class="w3-input w3-border sh-input" required id="user_address" disabled />
					</div>
				</div>

				<div class="w3-container" style="margin-top:10px; margin-bottom: 10px; padding-right: 70px;" >
					<button id="edit_info_btn" class="w3-btn w3-teal w3-right" style="width: 80px;" >Edit</button>
					<button id="cancel_update_btn" class="w3-btn w3-green w3-right" style="width: 80px; display:none;" >Cancel</button>
					<button id="confirm_update_btn" class="w3-btn w3-red w3-right w3-margin-right" style="width: 80px; display: none;" >Update</button>
				</div>

			</div>

			</div>


			
		</div>



		
	</body>
	

	<!-- POST-LOADING SCRIPTS -->
	<!-- *********************************************** -->
	<script>

		/* hold book data from AJAX request */
		var account_info;

		$(document).ready(function(){

			/* no match error msg */
			/******************************************/
			//$("#no_match_msg").hide();

			/* disable input fields */
			/******************************************/
			$(".sh-input").attr('disabled', true);

			/* website logo */
			/******************************************/
			var src_url = "https://www.momdeals.com/vfiles/25-7b9c2f40aedba2587b86dad83e58312f.png";
			$("#logo_image").attr("src", src_url);
			$("#logo_image").attr("height", "60");
			$("#logo_image").attr("width", "200");
			$("#logo_image").css( 'cursor', 'pointer' );

			/* view table rows */
			/******************************************/
			/* update rows AJAX */
			var data_url = "http://127.0.0.1:8081/account/refresh_info";
		    $.get(data_url, function(data, status){
		    	
		    	// obtain data
		    	account_info = JSON.parse(data);
		    	update_account_fields();
		    });

		     /* personalized views */
			/******************************************/
			/* update rows AJAX */
			var data_url2 = "http://127.0.0.1:8081/home/update_views";
		    $.get(data_url2, function(data, status){
		    	
		    	// obtain data
		    	var personal_views = JSON.parse(data);
		    	$("#display_user_name").text(personal_views['user_name']);
		    	if(personal_views['credentials'] == 0){
		    		$("#admin_controls").remove();
		    	}else{
		    		$("#admin_controls").show();
		    	}

		    });

			/* form action listeners */
			/******************************************/
			$("#confirm_update_btn").hide();
			$("#cancel_update_btn").hide();

			$("#edit_info_btn").click(function(e){
				$("#edit_info_btn").hide();
				$("#confirm_update_btn").show();
				$("#cancel_update_btn").show();
				$(".sh-input").attr('disabled', false);
			});

			$("#cancel_update_btn").click(function(e){
				$("#confirm_update_btn").hide();
				$("#cancel_update_btn").hide();
				$("#edit_info_btn").show();
				$(".sh-input").attr('disabled', true);
			});

		    $('#confirm_update_btn').click(function(e){
		    	$("#confirm_update_btn").hide();
				$("#cancel_update_btn").hide();
				$("#edit_info_btn").show();

		    	var send_data = {
		    		user_name : $("#user_name").val(),
		    		user_password : $("#user_password").val(),
		    		first_name : $("#first_name").val(),
		    		last_name : $("#last_name").val(),
		    		user_email : $("#user_email").val(),
		    		user_phone : $("#user_phone").val(),
		    		user_address : $("#user_address").val()
		    	};

		    	var target_url = "http://127.0.0.1:8081/account/update_info";

				$.post(target_url, send_data, function(data, status){
					// obtain data
			    	//error_msg = JSON.parse(data);
				});

				$(".sh-input").attr('disabled', true);

				var data_url3 = "http://127.0.0.1:8081/home/update_views";
			    $.get(data_url3, function(data, status){
			    	// obtain data
			    	var personal_views = JSON.parse(data);
			    	$("#display_user_name").text(personal_views['user_name']);

			    });
			});

		    /* handle site navigation */
			/******************************************/
		    $("#logo_image").click(function(e){
				var target_url = "http://127.0.0.1:8081/home";
      			$( location ).attr("href", target_url);
			});
			$("#home_btn").click(function(e){
				var target_url = "http://127.0.0.1:8081/home";
      			$( location ).attr("href", target_url);
			});
			$("#cart_btn").click(function(e){
				var target_url = "http://127.0.0.1:8081/cart";
      			$( location ).attr("href", target_url);
			});
			$("#my_orders_btn").click(function(e){
				var target_url = "http://127.0.0.1:8081/my_orders";
      			$( location ).attr("href", target_url);
			});
			$("#signout_btn").click(function(e){
				var target_url = "http://127.0.0.1:8081/signout";
      			$( location ).attr("href", target_url);
			});

			$("#manage_inventory_btn").click(function(e){
				var target_url = "http://127.0.0.1:8081/manage_inventory";
      			$( location ).attr("href", target_url);
			});
			$("#manage_publishers_btn").click(function(e){
				var target_url = "http://127.0.0.1:8081/manage_publishers";
      			$( location ).attr("href", target_url);
			});
			$("#publisher_orders_btn").click(function(e){
				var target_url = "http://127.0.0.1:8081/publisher_orders";
      			$( location ).attr("href", target_url);
			});
			$("#user_accounts_btn").click(function(e){
				var target_url = "http://127.0.0.1:8081/user_accounts";
      			$( location ).attr("href", target_url);
			});

		});


		/*******************************
		left outside for scoping purpose
		********************************/

		/* update account info fields */
		/******************************************/
		function update_account_fields()
		{
			$("#user_name").val(account_info[0]["user_name"]);
			$("#user_password").val(account_info[0]["password"]);
			$("#first_name").val(account_info[0]["first_name"]);
			$("#last_name").val(account_info[0]["last_name"]);
			$("#user_email").val(account_info[0]["email"]);
			$("#user_phone").val(account_info[0]["phone"]);
			$("#user_address").val(account_info[0]["address"]);
		}

	</script>
	
</html>
